import{u as M,a as T,w as S,r as N,S as i,b as C,j as e,P as B,T as t,f as x,I as E,B as f,l as z,c as o,d as b,o as D,e as H,g as G,h as _}from"./index-C4ncSKLu.js";import{u as V,o as h,r as w,M as v,L as q,a as I}from"./transaction-list-svgs-D9VknjVW.js";const A=function(){const p=M(),{address:j}=T(),{data:r=[],isFetching:y}=V({...S,functionName:"getTransactions",args:[j],query:{enabled:!!j}}),u=N.useMemo(()=>({totalInvested:r.reduce((s,l)=>s+l.amount,0n),remainingBalance:(()=>{let s=0n;return r.forEach(l=>{l.milestones.forEach(a=>{a.status===i.unpaid&&(s+=a.amount)})}),s})(),totalDisbursed:(()=>{let s=0n;return r.forEach(l=>{l.milestones.forEach(a=>{a.status===i.paid&&(s+=a.amount)})}),s})()}),[r]),c=C("transaction-details-home",{onClose(s){s(),g(null)}}),[d,g]=N.useState(null);return e.jsxs(B,{className:"flex flex-col gap-y-5",children:[e.jsx(t,{variant:"h1",children:"GM, Mich"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full rounded-t-3xl rounded-br-3xl bg-em-tertiary py-4 px-5 flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-0",children:[e.jsxs(t,{variant:"h3",children:[x(u.remainingBalance)," ETH"]}),e.jsx(t,{className:"text-white text-sm",children:"Remaining Balance"})]}),e.jsx("div",{className:"w-fit h-fit -mt-0.5",children:e.jsx(h,{className:"size-20"})})]}),e.jsxs("div",{className:"w-full grid grid-cols-[45%_55%] bg-em-tertiary rounded-b-3xl",children:[e.jsx("div",{className:"bg-em-primary",children:e.jsx("div",{className:"w-full h-full rounded-b-3xl bg-em-tertiary py-4 px-5 flex justify-between items-start ",children:e.jsxs("div",{className:"space-y-0",children:[e.jsxs(t,{variant:"h3",children:[x(u.totalInvested)," ETH"]}),e.jsx(t,{className:"text-white text-sm",children:"Total Invested"})]})})}),e.jsx("div",{className:"pl-2 pt-2 bg-em-primary rounded-tl-3xl ",children:e.jsx("div",{className:"w-full rounded-3xl bg-em-green py-4 px-5 flex justify-between items-start",children:e.jsxs("div",{className:"space-y-0",children:[e.jsxs(t,{variant:"h3",children:[x(u.totalDisbursed)," ETH"]}),e.jsx(t,{className:"text-white text-sm",children:"Total Disbursed"})]})})})]})]}),y?e.jsx(E,{}):r.length>0?e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"w-full flex items-center justify-between ",children:[e.jsx(t,{className:"font-bold ",children:"Transactions"}),e.jsx(f,{onTap:()=>p({to:"/transactions"}),className:"p-0 underline text-sm font-medium",variant:"ghost",children:"See all"})]}),e.jsx("div",{className:"space-y-3",children:r.map((s,l)=>{const a=s.milestones.every(m=>m.status===i.paid),n=(()=>{var m;return{firstMilestoneCompleted:s.milestones[0].status===i.paid,hasMultipleMilestones:s.milestones.length>1,secondMilestoneCompleted:((m=s.milestones[1])==null?void 0:m.status)===i.paid,moreThan2Milestones:s.milestones.length>2?{inBetween:s.milestones.slice(1,s.milestones.length-1),lastMilestoneCompleted:z(s.milestones).status===i.paid}:null}})();return e.jsxs("div",{onClick:()=>{g(s),c.openSheet()},className:"w-full flex cursor-pointer items-start gap-x-2",children:[e.jsx("div",{className:o("size-12 min-w-12 min-h-12 flex items-center justify-center bg-em-tertiary/50 rounded-full",{"bg-em-green/50":a}),children:a?e.jsx(w,{className:o("size-7")}):e.jsx(h,{className:o("size-7")})}),e.jsxs("div",{className:"flex flex-col gap-y-1 w-[65%] items-start ",children:[e.jsx(t,{className:"font-bold whitespace-nowrap overflow-hidden overflow-ellipsis w-full",children:s.title}),e.jsxs("div",{className:"w-full flex pt-4 pb-2 bg-orange-",children:[e.jsx(v,{size:1,completed:n.firstMilestoneCompleted}),n.hasMultipleMilestones&&(n.moreThan2Milestones?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:.8,completed:n.secondMilestoneCompleted,className:"-mt-1 -ml-[7px]"}),e.jsxs(t,{className:"text-em-text font-bold text-xs -mt-2 mx-1.5 whitespace-nowrap",children:[n.moreThan2Milestones.inBetween.length," ","more"]}),e.jsx(I,{size:.8,completed:n.moreThan2Milestones.lastMilestoneCompleted,className:"-mt-[9px] -ml-"})]}):e.jsx(v,{size:1,completed:n.secondMilestoneCompleted,className:"-mt-2.5 -ml-[7px]"}))]})]}),e.jsxs("div",{className:"w-fit flex flex-col gap-y-1 items-end ml-auto",children:[e.jsxs(t,{className:"font-semibold whitespace-nowrap",children:[x(s.amount)," ETH"]}),e.jsx(t,{className:"font-medium text-em-text text-xs",children:a?"Completed":"Ongoing"})]})]},l)})})]}):e.jsxs("div",{className:"w-full flex flex-col gap-y-6 px-4 pb-4 pt-6 bg-em-tertiary rounded-[28px]",children:[e.jsx(t,{className:"w-full font-Bricolage_Grotesque font-semibold text-center text-lg",children:"No transactions yet"}),e.jsx(f,{variant:"full",className:"w-full",onTap:()=>p({to:"/create-transaction"}),children:"Create Transaction"})]}),d&&e.jsx(c.VariableHeightSheet,{title:"Transaction Details",backButton:"Back",children:e.jsxs(c.VariableHeightSheetContent,{className:"flex flex-col flex-grow gap-y-3 overflow-y-auto no-scrollbar",children:[e.jsxs("div",{className:"w-full pb-2 px-2.5 border-b-2 border-b-[#D3D3D3] py-2 flex flex-col gap-y-3",children:[e.jsxs("div",{className:"w-full flex items-center justify-between gap-x-2",children:[e.jsx(t,{className:"text-em-text",children:"Transaction Title:"}),e.jsx(t,{className:"text-em-green font-medium font-Bricolage_Grotesque text-base overflow-ellipsis overflow-hidden bg-em-green/10 rounded-xl px-3 py-1",children:d.title})]}),e.jsxs("div",{className:"w-full flex items-center justify-between gap-x-2",children:[e.jsx(t,{className:"text-em-text",children:"Total:"}),e.jsxs(t,{className:"text-em-tertiary font-medium font-Bricolage_Grotesque text-base overflow-ellipsis overflow-hidden bg-em-primary/60 rounded-xl px-3 py-1",children:[b(d.amount)," ETH"]})]})]}),e.jsx("div",{className:"flex-grow grid px-2.5 pt-5 overflow-y-auto no-scrollbar mb-4",children:e.jsx("div",{className:"flex flex-col relative ",children:d.milestones.map((s,l)=>e.jsxs("div",{className:"w-full flex items-start gap-x-3",children:[e.jsx("div",{className:o("min-w-12 min-h-12 flex items-center justify-center bg-em-tertiary/50 rounded-full",{"bg-em-green/50":s.status===i.paid}),children:s.status===i.paid?e.jsx(w,{className:o("size-7")}):e.jsx(h,{className:o("size-7")})}),e.jsxs("div",{className:"h-[160px] flex-grow space-y-3",children:[e.jsx(t,{className:"font-bold font-Bricolage_Grotesque rounded-xl pl-4 pr-3 py-2.5 bg-gray-400/10 backdrop-blur-[12px] flex items-center justify-between",children:s.title}),e.jsxs("div",{className:"w-full flex items-center gap-x-3",children:[e.jsx(D,{}),e.jsx(t,{className:"font-bold font-Bricolage_Grotesque bg-orange-200 px-3 py-1 rounded-lg",children:H(G(s.deadline),"do MMMM, yyyy")})]}),e.jsxs("div",{className:"w-full flex items-center gap-x-3",children:[e.jsx(_,{}),e.jsxs(t,{className:"font-bold bg-lime-200 px-3 py-1 rounded-lg",children:[b(s.amount)," ETH"]})]})]})]},l))})}),e.jsx(f,{variant:"full",className:"w-full",onTap:()=>c.closeSheet(),children:"Close"})]})})]})};export{A as component};
